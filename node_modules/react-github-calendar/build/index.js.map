{"version":3,"file":"index.js","sources":["../src/constants.ts","../src/utils.ts","../src/index.tsx"],"sourcesContent":["// GitHub theme\nimport { Theme } from 'react-activity-calendar';\n\nexport const API_URL = 'https://github-contributions-api.jogruber.de/v4/';\n\nexport const DEFAULT_THEME: Theme = {\n  level4: '#216e39',\n  level3: '#30a14e',\n  level2: '#40c463',\n  level1: '#9be9a8',\n  level0: '#ebedf0',\n};\n","// noinspection SuspiciousTypeOfGuard The caller might not use TypeScript\n\nimport { CalendarData } from 'react-activity-calendar';\n\nimport { Props } from './index';\n\nexport const transformData = (\n  data: CalendarData,\n  transformFn?: Props['transformData'],\n): CalendarData => {\n  if (typeof transformFn !== 'function') {\n    return data;\n  }\n\n  const transformedData = transformFn(data);\n\n  if (!Array.isArray(transformedData)) {\n    throw new Error(`Passed function transformData must return a list of Day objects.`);\n  }\n\n  if (transformedData.length > 0) {\n    const testObj = transformedData[0];\n\n    if (typeof testObj.count !== 'number' || testObj.count < 0) {\n      throw new Error(\n        `Required property \"count: number\" missing or invalid. Got: ${testObj.count}`,\n      );\n    }\n\n    if (!/\\d{4}-\\d{2}-\\d{2}/.test(testObj.date)) {\n      throw new Error(\n        `Required property \"date: YYYY-MM-DD\" missing or invalid. Got: ${testObj.date}`,\n      );\n    }\n\n    if (typeof testObj.level !== 'number' || testObj.level < 0 || testObj.level > 4) {\n      throw new Error(\n        `Required property \"level: 0 | 1 | 2 | 3 | 4\" missing or invalid: Got: ${testObj.level}.`,\n      );\n    }\n  }\n\n  return transformedData;\n};\n","import React, { FunctionComponent, useCallback, useEffect, useState } from 'react';\nimport Calendar, {\n  createCalendarTheme,\n  Skeleton,\n  type CalendarData,\n  type Props as CalendarProps,\n} from 'react-activity-calendar';\n\nimport { API_URL, DEFAULT_THEME } from './constants';\nimport { ApiErrorResponse, ApiResponse, Year } from './types';\nimport { transformData } from './utils';\n\nexport interface Props extends Omit<CalendarProps, 'data'> {\n  username: string;\n  year?: Year;\n  transformData?: (data: CalendarData) => CalendarData;\n  transformTotalCount?: boolean;\n}\n\nasync function fetchCalendarData(username: string, year: Year): Promise<ApiResponse> {\n  const response = await fetch(`${API_URL}${username}?y=${year}`);\n  const data: ApiResponse | ApiErrorResponse = await response.json();\n\n  if (!response.ok) {\n    throw new Error((data as ApiErrorResponse).error);\n  }\n\n  return data as ApiResponse;\n}\n\nconst GitHubCalendar: FunctionComponent<Props> = ({\n  username,\n  year = 'last',\n  labels,\n  transformData: transformDataProp,\n  transformTotalCount = true,\n  ...props\n}) => {\n  const [data, setData] = useState<CalendarData | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  const fetchData = useCallback(() => {\n    setLoading(true);\n    setError(null);\n    fetchCalendarData(username, year)\n      .then(({ contributions }) => setData(contributions))\n      .catch(setError)\n      .finally(() => setLoading(false));\n  }, [username, year]);\n\n  useEffect(fetchData, [fetchData]);\n\n  if (error) {\n    return (\n      <div>\n        <i>Unable to fetch contribution data. See console.</i>\n      </div>\n    );\n  }\n\n  if (loading || !data) {\n    return <Skeleton {...props} loading />;\n  }\n\n  const theme = props.color ? undefined : props.theme ?? DEFAULT_THEME;\n\n  const defaultLabels = {\n    totalCount: `{{count}} contributions in ${year === 'last' ? 'the last year' : '{{year}}'}`,\n  };\n\n  const totalCount = transformTotalCount\n    ? undefined\n    : data.reduce((sum, day) => sum + day.count, 0);\n\n  return (\n    <Calendar\n      data={transformData(data, transformDataProp)}\n      theme={theme}\n      labels={Object.assign({}, defaultLabels, labels)}\n      totalCount={totalCount}\n      {...props}\n    />\n  );\n};\n\nexport { createCalendarTheme };\nexport default GitHubCalendar;\n"],"names":["API_URL","DEFAULT_THEME","level4","level3","level2","level1","level0","transformData","data","transformFn","transformedData","Array","isArray","Error","length","testObj","count","test","date","level","fetchCalendarData","username","year","response","fetch","json","ok","error","GitHubCalendar","labels","transformDataProp","transformTotalCount","props","setData","useState","loading","setLoading","setError","fetchData","useCallback","then","contributions","catch","finally","useEffect","React","Skeleton","theme","color","undefined","defaultLabels","totalCount","reduce","sum","day","Calendar","Object","assign"],"mappings":"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"}